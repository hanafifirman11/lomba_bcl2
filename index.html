<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peserta Lomba 17 Agustus 2024</title>
    <link rel="icon" href="./logo-bcl2.jpeg" type="image/png"> <!-- Menambahkan favicon -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.6.0/jspdf.umd.min.js"></script>

    <!-- PapaParse for CSV generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <!-- SheetJS (xlsx) for Excel generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- jsPDF AutoTable library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.16/jspdf.plugin.autotable.min.js"></script>


    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0px;
            background-color: #f0f0f0;
            box-sizing: border-box;
        }
        .nav-tabs .nav-link.active {
            background-color: #17a2b8;
            color: white;
        }
        /* table {
            transition: transform 0.2s;
        }
        table:hover {
            transform: scale(1.02);
        } */
        .header-title {
            text-align: center;
            margin: 0;
        }
        .header-title img {
            display: block;
            margin: 0 auto;
            max-width: 40%; /* Ukuran logo di desktop */
            vertical-align: middle;
        }
        .header-title h1 {
            margin: 0px 0;
            font-size: 18px;
        }
        
        .tournament {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .tournament h2 {
            margin: 10px 0;
        }
        iframe {
            width: 100%;
            height: 700px;
            border: none;
        }

        .footer {
            text-align: center;
            padding: 20px;
            background-color: #f8f9fa;
            margin-top: 20px;
        }
        
    </style>
</head>
<body>

<div class="container mt-5">
    <div class="header-title">
        <img src="./logo-bcl2.png" alt="Logo">
    </div>
    <div class="header-title">
        <h1>Peserta Lomba 17 Agustusan 2024</h1>
    </div>
    <ul class="nav nav-tabs justify-content-center" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="anak5-tab" data-bs-toggle="tab" data-bs-target="#anak5" type="button" role="tab" aria-controls="anak5" aria-selected="true">Anak 5 Tahun Kebawah</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="anak6-10-tab" data-bs-toggle="tab" data-bs-target="#anak6-10" type="button" role="tab" aria-controls="anak6-10" aria-selected="false">Anak 6-10 Tahun</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="dewasa-tab" data-bs-toggle="tab" data-bs-target="#dewasa" type="button" role="tab" aria-controls="dewasa" aria-selected="false">Dewasa</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="turnamen-tab" data-bs-toggle="tab" data-bs-target="#turnamen" type="button" role="tab" aria-controls="turnamen" aria-selected="false">Turnamen Group</button>
        </li>
    </ul>
    <div class="tab-content mt-4" id="myTabContent">
        <div class="tab-pane fade show active" id="anak5" role="tabpanel" aria-labelledby="anak5-tab">
            <div class="table-responsive">
                <div class="filter-container">
                    <label for="filterLomba">Jenis Lomba:</label>
                    <select id="filterLomba" class="form-select">
                        <option value="">Semua</option>
                        <option value="Lomba Mewarnai">Lomba Mewarnai</option>
                        <option value="Fashion Show">Fashion Show</option>
                        <option value="Sepeda Hias">Sepeda Hias</option>
                        <option value="Estafet Bola">Estafet Bola</option>
                        <option value="Estafet Bendera">Estafet Bendera</option>
                        <option value="Menyuapi Orang Tua Dengan Mata Tertutup">Menyuapi Orang Tua Dengan Mata Tertutup</option>
                    </select>
                </div>

                <div class="text-center mt-4">
                    <button id="printPDF" class="btn btn-primary">Print PDF</button>
                    <button id="exportCSV" class="btn btn-secondary">Export CSV</button>
                    <button id="exportExcel" class="btn btn-success">Export Excel</button>
                </div>
                

                <table class="table table-striped table-hover mt-3">
                    <thead class="table-dark">
                        <tr>
                            <th>No</th>
                            <th>Nama</th>
                            <th>Alamat</th>
                            <th>RT</th>
                            <th>Jenis Lomba</th>
                        </tr>
                    </thead>
                    <tbody id="tableAnak5">
                        <!-- Data untuk Anak 5 Tahun Kebawah -->
                    </tbody>
                </table>
            </div>
        </div>
        <div class="tab-pane fade" id="anak6-10" role="tabpanel" aria-labelledby="anak6-10-tab">
            <div class="table-responsive">
                <div class="filter-container">
                    <label for="filterLomba10">Jenis Lomba:</label>
                    <select id="filterLomba10" class="form-select">
                        <option value="">Semua</option>
                        <option value="Balap Karung">Balap Karung</option>
                        <option value="Lomba Makan Kerupuk">Lomba Makan Kerupuk</option>
                        <option value="Balap Kelereng pakai masker">Balap Kelereng pakai masker</option>
                        <option value="Mengeluarkan bola dari dalam kardus">Mengeluarkan bola dari dalam kardus</option>
                        <option value="Memasukan pensil dalam botol">Memasukan pensil dalam botol</option>
                        <option value="Memecahkan Balon di kursi">Memecahkan Balon di kursi</option>
                        <option value="Fashion Show">Fashion Show</option>
                        <option value="Sepeda Hias">Sepeda Hias</option>
                    </select>
                </div>

                <div class="text-center mt-4">
                    <button id="printPDF10" class="btn btn-primary">Print PDF</button>
                    <button id="exportCSV10" class="btn btn-secondary">Export CSV</button>
                    <button id="exportExcel10" class="btn btn-success">Export Excel</button>
                </div>
                <table class="table table-striped table-hover mt-3">
                    <thead class="table-dark">
                        <tr>
                            <th>No</th>
                            <th>Nama</th>
                            <th>Alamat</th>
                            <th>RT</th>
                            <th>Jenis Lomba</th>
                        </tr>
                    </thead>
                    <tbody id="tableAnak6-10">
                        <!-- Data untuk Anak 6-10 Tahun -->
                    </tbody>
                </table>
            </div>
        </div>
        <div class="tab-pane fade" id="dewasa" role="tabpanel" aria-labelledby="dewasa-tab">
            <div class="table-responsive">
                <div class="filter-container">
                    <label for="filterLombaDewasa">Jenis Lomba:</label>
                    <select id="filterLombaDewasa" class="form-select">
                        <option value="">Semua</option>
                        <option value="Tarik Tambang">Tarik Tambang</option>
                        <option value="Balap Bakiak">Balap Bakiak</option>
                        <option value="Memecahkan Balon Dengan Mata Tertutup">Memecahkan Balon Dengan Mata Tertutup</option>
                        <option value="Estafet Sarung">Estafet Sarung</option>
                        <option value="Estafet Kardus">Estafet Kardus</option>
                        <option value="Tenis Meja">Tenis Meja</option>
                        <option value="Mini Soccer memakai Sarung">Mini Soccer memakai Sarung</option>
                        <option value="Ambil Koin di pepaya di lumuri Coklat">Ambil Koin di pepaya di lumuri Coklat</option>
                        <option value="Menurunkan Karet di muka">Menurunkan Karet di muka</option>
                        <option value="Lempar  air dalam plastik">Lempar  air dalam plastik</option>
                        <option value="Gotong royong ember">Gotong royong ember</option>
                        <option value="Mengeluarkan bola dari dalam tepung">Mengeluarkan bola dari dalam tepung</option>
                        <option value="Playstation ( PES )">Playstation ( PES )</option>
                    </select>
                </div>

                <div class="text-center mt-4">
                    <button id="printPDFDewasa" class="btn btn-primary">Print PDF</button>
                    <button id="exportCSVDewasa" class="btn btn-secondary">Export CSV</button>
                    <button id="exportExcelDewasa" class="btn btn-success">Export Excel</button>
                </div>
                <table class="table table-striped table-hover mt-3">
                    <thead class="table-dark">
                        <tr>
                            <th>No</th>
                            <th>Nama</th>
                            <th>Alamat</th>
                            <th>RT</th>
                            <th>Jenis Lomba</th>
                        </tr>
                    </thead>
                    <tbody id="tableDewasa">
                        <!-- Data untuk Dewasa -->
                    </tbody>
                </table>
            </div>
        </div>
        <div class="tab-pane fade" id="turnamen" role="tabpanel" aria-labelledby="turnamen-tab">
            <div class="container">
                <div class="tournament">
                    <h2>Badminton Bapa-bapa</h2>
                    <iframe src="https://challonge.com/bcl2_badminton_bapa/module" width="100%" height="500" frameborder="0" scrolling="auto" allowtransparency="true"></iframe>
                </div>
                <div class="tournament">
                    <h2>Badminton Ibu-ibu</h2>
                    <iframe src="https://challonge.com/bcl2_badminton_ibuk/module" width="100%" height="500" frameborder="0" scrolling="auto" allowtransparency="true"></iframe>
                </div>
                <div class="tournament">
                    <h2>Tenis Meja</h2>
                    <iframe src="https://challonge.com/bcl2_tenis_meja/module" width="100%" height="500" frameborder="0" scrolling="auto" allowtransparency="true"></iframe>
                </div>
                <div class="tournament">
                    <h2>Mobile Legend</h2>
                    <iframe src="https://challonge.com/bcl_mobile_legend/module" width="100%" height="500" frameborder="0" scrolling="auto" allowtransparency="true"></iframe>
                </div>
                <div class="tournament">
                    <h2>Voli Bapa-bapa</h2>
                    <iframe src="https://challonge.com/bcl2_voli_bapa/module" width="100%" height="500" frameborder="0" scrolling="auto" allowtransparency="true"></iframe>
                </div>
                <div class="tournament">
                    <h2>Voli Ibu-ibu</h2>
                    <iframe src="https://challonge.com/bcl2_voli_ibu/module" width="100%" height="500" frameborder="0" scrolling="auto" allowtransparency="true"></iframe>
                </div>
                <div class="tournament">
                    <h2>Mini Soccer</h2>
                    <iframe src="https://challonge.com/bcl_minisoccer/module" width="100%" height="500" frameborder="0" scrolling="auto" allowtransparency="true"></iframe>
                </div>
            </div>
        </div>
    </div>
    <div class="footer">
        <p>Powered by Firman Hanafi</p>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>

async function fetchData(url) {
        const response = await fetch(url);
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    }

    function populateTable(data, tableId) {
        const tableBody = document.getElementById(tableId);
        tableBody.innerHTML = ''; // Clear existing rows
        
        data.forEach((item, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${index + 1}</td> <!-- Generate sequence number -->
                <td>${item.Nama}</td>
                <td>${item.Alamat}</td>
                <td>${item.RT}</td>
                <td>${item.JenisLomba}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    function filterTable(data, filterValue) {
        return data.filter(item => !filterValue || item.JenisLomba === filterValue);
    }

    document.addEventListener('DOMContentLoaded', async function() {
        try {
            const dataAnak5 = await fetchData('https://raw.githubusercontent.com/hanafifirman11/lomba_bcl2/main/dataAnak5_1.json');
            populateTable(dataAnak5, 'tableAnak5');

            // Fetch and populate other tables similarly
            const dataAnak6_10 = await fetchData('https://raw.githubusercontent.com/hanafifirman11/lomba_bcl2/main/dataAnak10.json');
            populateTable(dataAnak6_10, 'tableAnak6-10');

            const dataDewasa = await fetchData('https://raw.githubusercontent.com/hanafifirman11/lomba_bcl2/main/dataDewasa.json');
            populateTable(dataDewasa, 'tableDewasa');

            document.getElementById('filterLomba').addEventListener('change', function() {
                const filterValue = this.value;
                const filteredData = filterTable(dataAnak5, filterValue);
                populateTable(filteredData, 'tableAnak5');
            });

            document.getElementById('printPDF').addEventListener('click', function() {
                window.print();
            });

            document.getElementById('exportCSV').addEventListener('click', function() {
                exportCSV('tableAnak5');
            });

            document.getElementById('exportExcel').addEventListener('click', function() {
                exportExcel('tableAnak5');
            });




            // Anak 6-10 Tahun
            document.getElementById('filterLomba10').addEventListener('change', function() {
                const filterValue = this.value;
                const filteredData = filterTable(dataAnak6_10, filterValue);
                populateTable(filteredData, 'tableAnak6-10');
            });

            document.getElementById('printPDF10').addEventListener('click', function() {
                window.print();
            });

            document.getElementById('exportCSV10').addEventListener('click', function() {
                exportCSV('tableAnak6-10');
            });

            document.getElementById('exportExcel10').addEventListener('click', function() {
                exportExcel('tableAnak6-10');
            });



            // Dewasa
            document.getElementById('filterLombaDewasa').addEventListener('change', function() {
                const filterValue = this.value;
                const filteredData = filterTable(dataDewasa, filterValue);
                populateTable(filteredData, 'tableDewasa');
            });

            document.getElementById('printPDFDewasa').addEventListener('click', function() {
                window.print();
            });

            document.getElementById('exportCSVDewasa').addEventListener('click', function() {
                exportCSV('tableDewasa');
            });

            document.getElementById('exportExcelDewasa').addEventListener('click', function() {
                exportExcel('tableDewasa');
            });
        } catch (error) {
            console.error('Error fetching data:', error);
        }
        
    });

    async function generatePDF(tableId) {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        // Check if autoTable is available
        if (typeof doc.autoTable !== 'function') {
            console.error('jsPDF AutoTable plugin not loaded');
            return;
        }

        const table = document.getElementById(tableId);
        
        // Add title to PDF
        doc.text('Laporan Daftar Lomba 17 Agustus', 10, 10);

        // Add table to PDF
        doc.autoTable({ html: table, startY: 20 });

        // Save PDF
        const pdfOutput = doc.output('bloburl'); // Generate a Blob URL for the PDF

        // Open the Blob URL in a new tab
        window.open(pdfOutput);
    }

    function exportCSV(tableId) {
        const table = document.getElementById(tableId);
        const rows = Array.from(table.querySelectorAll('tr')).map(row => {
            return Array.from(row.querySelectorAll('td, th')).map(cell => cell.innerText).join(',');
        }).join('\n');

        const csvContent = 'data:text/csv;charset=utf-8,' + encodeURIComponent(rows);
        const link = document.createElement('a');
        link.setAttribute('href', csvContent);
        link.setAttribute('download', 'report.csv');
        link.click();
    }

    function exportExcel(tableId) {
        const table = document.getElementById(tableId);
        const wb = XLSX.utils.table_to_book(table, { sheet: 'Sheet1' });
        XLSX.writeFile(wb, 'report.xlsx');
    }

</script>
</body>
</html>
